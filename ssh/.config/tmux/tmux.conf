# ── Prefix: Ctrl-Space (kill Ctrl-b) ─────────────────────────
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# ── General ───────────────────────────────────────────────────
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"
set -g mouse on
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g escape-time 0           # CRITICAL for nvim — no Esc delay
set -g history-limit 50000
set -g focus-events on         # nvim autoread
set -g set-clipboard on
setw -g mode-keys vi

# ══════════════════════════════════════════════════════════════
# NAVIGATION — mirrors <space>wh/j/k/l
# ══════════════════════════════════════════════════════════════
bind h select-pane -L          # <space>wh → Window Go Left
bind j select-pane -D          # <space>wj → Window Go Down
bind k select-pane -U          # <space>wk → Window Go Up
bind l select-pane -R          # <space>wl → Window Go Right

# Alt+h/j/k/l — no prefix needed (for when you're flying)
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R

# ══════════════════════════════════════════════════════════════
# SPLITS — mirrors <space>wv and <space>ws
# ══════════════════════════════════════════════════════════════
unbind '"'
unbind %
bind v split-window -h -c "#{pane_current_path}"   # <space>wv → Vertical Split
bind s split-window -v -c "#{pane_current_path}"   # <space>ws → Horizontal Split

# ══════════════════════════════════════════════════════════════
# CLOSE — mirrors <space>wq and <space>wo
# ══════════════════════════════════════════════════════════════
bind q kill-pane               # <space>wq → Close Window
bind o kill-pane -a            # <space>wo → Close Other Windows (kill all but current)

# ══════════════════════════════════════════════════════════════
# RESIZE — mirrors <space>w= / w+ / w- / w> / w<
# ══════════════════════════════════════════════════════════════
bind = select-layout tiled     # <space>w= → Equalize Sizes
bind -r + resize-pane -U 5     # <space>w+ → Increase Height
bind -r - resize-pane -D 5     # <space>w- → Decrease Height
bind -r > resize-pane -R 5     # <space>w> → Increase Width
bind -r < resize-pane -L 5     # <space>w< → Decrease Width

# Also support Shift h/j/k/l for resize (vim muscle memory)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# ══════════════════════════════════════════════════════════════
# OTHER — mirrors <space>ww / wr / wx / wT
# ══════════════════════════════════════════════════════════════
bind w select-pane -t :.+      # <space>ww → Cycle Windows
bind r rotate-window           # <space>wr → Rotate Windows
bind x swap-pane -D            # <space>wx → Exchange Windows
bind T break-pane              # <space>wT → Move to New Tab (window)
bind S choose-tree -Zs          # session chooser (was default C-b s)

# ══════════════════════════════════════════════════════════════
# BUFFER — mirrors <leader>bk / bo
# ══════════════════════════════════════════════════════════════
bind b switch-client -T buffer_table
bind -T buffer_table k kill-window                                    # <leader>bk → Kill Buffer (≈ window)
bind -T buffer_table o kill-window -a                                 # <leader>bo → Delete Other Buffers

# ══════════════════════════════════════════════════════════════
# WINDOW (tab) NAVIGATION
# ══════════════════════════════════════════════════════════════
bind n new-window -c "#{pane_current_path}"    # new window (since 'c' is freed up)
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9
bind [ previous-window
bind ] next-window

# ══════════════════════════════════════════════════════════════
# COPY MODE (vim style)
# ══════════════════════════════════════════════════════════════
bind Enter copy-mode
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel
bind -T copy-mode-vi Escape send -X cancel

# ══════════════════════════════════════════════════════════════
# ZOOM — no nvim equivalent, but useful
# ══════════════════════════════════════════════════════════════
bind m resize-pane -Z           # maximize/restore pane

# ══════════════════════════════════════════════════════════════
# RELOAD
# ══════════════════════════════════════════════════════════════
bind R source-file ~/.config/tmux/tmux.conf \; display "Config reloaded"

# ══════════════════════════════════════════════════════════════
# APPEARANCE (minimal, stays out of the way)
# ══════════════════════════════════════════════════════════════
set -g status-position bottom
set -g status-style "bg=#1e2030,fg=#828bb8"
set -g status-left "#[fg=#1b1d2b,bg=#82aaff,bold] #S #[bg=#1e2030] "
set -g status-left-length 30
set -g status-right ""
set -g status-justify left

setw -g window-status-format "#[fg=#3b4261] #I:#W "
setw -g window-status-current-format "#[fg=#1b1d2b,bg=#82aaff,bold] #I:#W "

set -g pane-border-style "fg=#3b4261"
set -g pane-active-border-style "fg=#82aaff"
set -g message-style "bg=#1e2030,fg=#828bb8"

# ══════════════════════════════════════════════════════════════
# vim-tmux-navigator (OPTIONAL — uncomment both this block AND
# the C-h/j/k/l lines in your nvim keybindings.lua to get
# seamless pane navigation across nvim ↔ tmux)
# ══════════════════════════════════════════════════════════════
# is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
#     | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|l?n?vim?x?|fzf)(diff)?$'"
# bind -n 'C-h' if-shell "$is_vim" 'send-keys C-h' 'select-pane -L'
# bind -n 'C-j' if-shell "$is_vim" 'send-keys C-j' 'select-pane -D'
# bind -n 'C-k' if-shell "$is_vim" 'send-keys C-k' 'select-pane -U'
# bind -n 'C-l' if-shell "$is_vim" 'send-keys C-l' 'select-pane -R'
# bind -n 'C-\' if-shell "$is_vim" 'send-keys C-\\' 'select-pane -l'
